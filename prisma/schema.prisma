generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(uuid())
  name      String?
  email     String   @unique
  password  String
  role      Role     @default(CUSTOMER)
  profile   Profile?
  createdAt DateTime @default(now())
}

model Profile {
  id        String   @id @default(cuid())
  userId    String   @unique
  title     String?
  about     String?
  location  String?
  image     String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user        User         @relation(fields: [userId], references: [id])
  gigs        Gig[]
  experiences Experience[]
  educations  Education[]
  skills      Skill[]
  reviews     Review[]
  portfolio   Portfolio[]

}

model Experience {
  id          String    @id @default(cuid())
  title       String
  company     String
  description String
  from        DateTime
  to          DateTime?
  present     Boolean   @default(false)

  profile   Profile @relation(fields: [profileId], references: [id])  
  profileId String
}

model Education {
  id          String    @id @default(cuid())
  degree      String
  institution String
  from        DateTime
  to          DateTime?
  present     Boolean   @default(false)

  profile   Profile @relation(fields: [profileId], references: [id])
  profileId String
}

model Skill {
  id    String @id @default(cuid())
  name  String
  level Int

  profile   Profile @relation(fields: [profileId], references: [id])
  profileId String
}

model Portfolio {
  id          String   @id @default(cuid())
  profile     Profile  @relation(fields: [profileId], references: [id])
  profileId   String

  title       String
  description String
  projectImage String?   // optional image URL
  hours       Int
  rate        Float
  cost        Float      // calculated: hours * rate
  startDate   DateTime
  endDate     DateTime?

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Gig {
  id          String   @id @default(uuid())
  title       String
  description String
  price       Float
  location    String
  category    String?   // optional category for filtering
  status      String?   // optional status: active, completed, etc.
  image       String?   // optional gig image

  profile     Profile   @relation(fields: [profileId], references: [id])
  profileId   String

  reviews     Review[]  // relation to reviews
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

model Review {
  id         String   @id @default(uuid())
  rating     Int      // 1-5 stars
  comment    String?
  gig        Gig      @relation(fields: [gigId], references: [id])
  gigId      String
  reviewer   Profile  @relation(fields: [reviewerId], references: [id])
  reviewerId String
  createdAt  DateTime @default(now())
}

enum Role {
  WORKER
  CUSTOMER
}
